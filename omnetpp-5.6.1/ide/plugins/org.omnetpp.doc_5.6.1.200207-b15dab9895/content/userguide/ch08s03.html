<html><head><link rel="STYLESHEET" href="../book.css"  type="text/css"/><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Using Tkenv</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="OMNeT&#8288;+&#8288;+ User Guide"><link rel="up" href="ch08.html" title="Chapter 8. The Tkenv Graphical Runtime Environment"><link rel="prev" href="ch08s02.html" title="Overview of the User Interface"><link rel="next" href="ch08s04.html" title="Using Tkenv with a Debugger"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Using Tkenv</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch08s02.html">Prev</a> </td><th width="60%" align="center">Chapter 8. The Tkenv Graphical Runtime Environment</th><td width="20%" align="right"> <a accesskey="n" href="ch08s04.html">Next</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm2779"></a>Using Tkenv</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm2781"></a>Starting Tkenv</h3></div></div></div><p>When you launch a simulation from the IDE, by default it will be started with Tkenv.
        When it does not, you can explicitly select Tkenv in the <span class="emphasis"><em>Run</em></span> or <span class="emphasis"><em>Debug</em></span> dialog.
      </p><p>Tkenv is also the default when you start the simulation from the command line.
        When necessary, you can force Tkenv by adding the <code class="literal">-u Tkenv</code> switch to the command line.
      </p><p>The complete list of command-line options, related environment variables
        and configuration options can be found at the end of this chapter.
      </p></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm2789"></a>Setting Up and Running the Simulation</h3></div></div></div><p>On startup, Tkenv reads the ini file(s) specified on the command line (or <code class="literal">omnetpp.ini</code>
        if none is specified), and automatically sets up the simulation described in them.
        If they contain several simulation configurations, Tkenv will ask you which one you
        want to set up.
      </p><div class="figure"><a name="pictures/Tkenv-setup-dialog.png"></a><p class="title"><b>Figure 8.2. Setting Up a New Simulation</b></p><div class="figure-contents"><div class="screenshot"><div class="mediaobject" align="center"><img src="pictures/Tkenv-setup-dialog.png" align="middle" alt="Setting Up a New Simulation"></div></div></div></div><br class="figure-break"><p>Once a simulation has been set up (modules have been created and initialized),
        you can run it in various modes and examine its state. At any time you can restart
        the simulation, or set up another simulation. If you choose to quit Tkenv before the
        simulation finishes (or try to restart the simulation), Tkenv will ask you whether
        to finalize the simulation, which usually translates to saving summary statistics.
      </p><p>Functions related to setting up a simulation are in the <span class="emphasis"><em>File</em></span> menu.
        Some of these functions are:
      </p><div class="figure"><a name="pictures/Tkenv-file-menu.png"></a><p class="title"><b>Figure 8.3. The File menu</b></p><div class="figure-contents"><div class="screenshot"><div class="mediaobject" align="center"><img src="pictures/Tkenv-file-menu.png" align="middle" alt="The File menu"></div></div></div></div><br class="figure-break"><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2812"></a>Set up a Configuration</h4></div></div></div><p>This function lets you choose a configuration and run number from the ini file.
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2815"></a>Open Primary Ini File</h4></div></div></div><p>Opens the first ini file in an text window for viewing.
        </p></div><p>Simulation-related functions are in the <span class="emphasis"><em>Simulate</em></span> menu, and are accessible via
        toolbar icons and keyboard shortcuts as well.
      </p><div class="figure"><a name="pictures/Tkenv-simulate-menu.png"></a><p class="title"><b>Figure 8.4. The Simulate menu</b></p><div class="figure-contents"><div class="screenshot"><div class="mediaobject" align="center"><img src="pictures/Tkenv-simulate-menu.png" align="middle" alt="The Simulate menu"></div></div></div></div><br class="figure-break"><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2828"></a>Step</h4></div></div></div><p><span class="emphasis"><em>Step</em></span> lets you execute one simulation event, that at the front of the FES.
          The next event is always shown on the status bar. The module where the next event
          will be delivered is highlighted with a red rectangle on the graphical display.
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2832"></a>Run (or Normal Run)</h4></div></div></div><p>In <span class="emphasis"><em>Run</em></span> mode, the simulation runs with all tracing aids on. Message animation is active and
          inspector windows are updated after each event. Output messages are displayed in the main window and
          module output windows. You can stop the simulation with the <span class="emphasis"><em>Stop</em></span> button on the toolbar. You can
          fully interact with the user interface while the simulation is running (e.g. you can open inspectors, etc.).
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
          If you find this mode too slow or distracting, you may switch off animation features in
          the <span class="emphasis"><em>Preferences</em></span> dialog.
        </div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2839"></a>Fast Run</h4></div></div></div><p> In <span class="emphasis"><em>Fast</em></span> mode, animation is turned off. The inspectors and the message output windows
          are updated every 500 milliseconds (the actual number can be set in <span class="emphasis"><em>File|Preferences...</em></span>).
          Fast mode is several times faster than the Run mode; the speed can increase by up to 10 times
          (or up to the configured event count).
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2844"></a>Express Run</h4></div></div></div><p> In <span class="emphasis"><em>Express mode</em></span>, the simulation runs at about the same speed as with Cmdenv, all tracing
          disabled. Module log is not recorded. You can interact with the simulation only once in a while,
          thus the run-time overhead of the user interface is minimal. You have to explicitly click
          the <span class="emphasis"><em>Update inspectors</em></span> button if you want a display update.
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2849"></a>Run Until</h4></div></div></div><p>You can run the simulation until a specified simulation time, event number or
          until a specific message has been delivered or canceled. This is
          a valuable tool during debugging sessions (select <span class="emphasis"><em>Simulate | Run until...</em></span>).
          It is also possible to right-click on an event in the simulation timeline and choose
          the <span class="emphasis"><em>Run until this event</em></span> menu item.
        </p><div class="figure"><a name="pictures/Tkenv-rununtil.png"></a><p class="title"><b>Figure 8.5. The Run Until dialog</b></p><div class="figure-contents"><div class="screenshot"><div class="mediaobject" align="center"><img src="pictures/Tkenv-rununtil.png" align="middle" alt="The Run Until dialog"></div></div></div></div><br class="figure-break"></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2862"></a>Run Until Next Event</h4></div></div></div><p> It is also possible to run until an event occurs in a specified module. Browse for the
          module and choose <span class="emphasis"><em>Run until next event in this module.</em></span> Simulation will stop once an event occurs
          in the selected module.</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2866"></a>Debug Next Event</h4></div></div></div><p> This function is useful when you are running the simulation under a C&#8288;+&#8288;+ source-level
          debugger. <span class="emphasis"><em>Debug Next Event</em></span> will perform one simulation event just like <span class="emphasis"><em>Step</em></span>, but
          executes a software debugger breakpoint (<code class="literal">int3</code> or <code class="literal">SIGTRAP</code>) just before entering
          the module's event handling code (<code class="literal">handleMessage()</code> or <code class="literal">activity()</code>). This will
          cause the debugger to stop the program there, letting you examine state variables,
          single-step, etc. When you resume execution, Tkenv will get back control and become
          responsive again.
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2875"></a>Recording an Event Log</h4></div></div></div><p>The OMNeT&#8288;+&#8288;+ simulation kernel allows you to record event related information into a file
          which later can be used to analyze the simulation run using the <span class="emphasis"><em>Sequence Chart</em></span> tool in
          the IDE. Eventlog recording can be turned on with the <code class="literal">record-eventlog=true</code> ini file option,
          but also interactively, via the respective item in the <span class="emphasis"><em>Simulate</em></span> menu, or using a toobar button.
        </p><p>Note that the starting Tkenv with <code class="literal">record-eventlog=true</code> and turning on recording later
          does not result in exactly the same eventlog file. In the former case, all steps of setting up
          the network, such as module creations, are recorded as they happen; while for the latter,
          Tkenv has to "fake" a chain of steps that would result in the current state of the simulation.
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2883"></a>Conclude Simulation</h4></div></div></div><p> This function finalizes the simulation by invoking the user-supplied <code class="literal">finish()</code>
          member functions on all module and channel objects in the simulation. The customary
          implementation of <code class="literal">finish()</code> is to record summary statistics. The simulation cannot
          be continued afterwards.
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2888"></a>Rebuild Network</h4></div></div></div><p> Rebuilds the simulation by deleting the current network and setting it up again.
          Improperly written simulations often crash when <span class="emphasis"><em>Rebuild Network</em></span> is invoked; this is
          usually due to incorrectly written destructors in module classes.
        </p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a name="idm2892"></a>Inspecting Simulation Objects</h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2894"></a>Inspectors</h4></div></div></div><p> The <span class="emphasis"><em>Network Display</em></span>, the <span class="emphasis"><em>Log Viewer</em></span> and the <span class="emphasis"><em>Object Inspector</em></span>
          in the main window share some common properties: they display various aspects
          (graphical view / log messages / fields or contents) of a given object.
          Such UI parts are called <span class="emphasis"><em>inspectors</em></span> in Tkenv.
        </p><p> The three inspectors mentioned above are built into the main window, but
          you can open add additional ones at any time. The new inspectors will open in
          floating windows above the main window, and you can have any number of them open.
        </p><div class="figure"><a name="pictures/Tkenv-floating-inspector.png"></a><p class="title"><b>Figure 8.6. A floating inspector window</b></p><div class="figure-contents"><div class="screenshot"><div class="mediaobject" align="center"><img src="pictures/Tkenv-floating-inspector.png" align="middle" alt="A floating inspector window"></div></div></div></div><br class="figure-break"><p> Inspectors come in many flavours. They can be graphical like the network view
          or a histogram inspector, textual like a log viewer, tree-based like an object
          inspector, or something entirely different.
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2911"></a>Opening Inspectors</h4></div></div></div><p>Inspectors can be opened in various ways: by double-clicking an item in the
          <span class="emphasis"><em>Object Navigator</em></span> or in other inspectors; by choosing one of the <span class="emphasis"><em>Open...</em></span>
          menu items from the context menu of an object displayed on the UI;
          via the <span class="emphasis"><em>Find/Inspect Objects</em></span> dialog (see later); or even by directly entering
          the C&#8288;+&#8288;+ pointer of an object as a hex value. Inspector-related menu items are
          in the <span class="emphasis"><em>Inspect</em></span> menu.</p><div class="figure"><a name="pictures/Tkenv-inspect-menu.png"></a><p class="title"><b>Figure 8.7. The Inspect menu</b></p><div class="figure-contents"><div class="screenshot"><div class="mediaobject" align="center"><img src="pictures/Tkenv-inspect-menu.png" align="middle" alt="The Inspect menu"></div></div></div></div><br class="figure-break"></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2926"></a>History</h4></div></div></div><p> Inspectors always show some aspect of one simulation object, but
          they can change objects. For example, in the <span class="emphasis"><em>Network View</em></span>, when you double-click
          a submodule which is itself a compound module, the view will switch to
          showing the internals of that module; or, the <span class="emphasis"><em>Object Inspector</em></span> will always
          show information about the object last clicked in the UI.
          Inspectors maintain a navigable history: the <span class="emphasis"><em>Back</em></span>/<span class="emphasis"><em>Forward</em></span> functions
          go to the object inspected before/after the currently displayed object.
          Objects that are deleted during simulation also disappear from the history.
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2933"></a>Restoring Inspectors</h4></div></div></div><p> When you exit and then restart a simulation program, Tkenv tries to restore
          the open inspector windows. However, as object identity is not preserved
          across different runs of the same program, Tkenv uses the object full path,
          class name and object ID (where exists) to find and identify the object
          to be inspected.
        </p><p> Preferences such as zoom level or open/closed state of a tree node are usually
          maintained per object type (i.e. tied to the C&#8288;+&#8288;+ class of the inspected object).
        </p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a name="idm2937"></a>Extending Tkenv</h4></div></div></div><p> It is possible for the user to contribute new inspector types without
          modifying Tkenv code. For this, the inspector C&#8288;+&#8288;+ code needs to include
          Tkenv header files and link with the Tkenv library. One caveat is that the
          Tkenv headers are not public API and thus subject to change in a new version
          of OMNeT&#8288;+&#8288;+.
        </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch08s02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch08.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch08s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Overview of the User Interface </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Using Tkenv with a Debugger</td></tr></table></div></body></html>
